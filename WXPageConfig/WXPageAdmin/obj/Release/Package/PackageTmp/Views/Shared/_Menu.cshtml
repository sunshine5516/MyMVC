
@{
    WXPageBLL.Concrete.WXAdminMenuBLL bll = new WXPageBLL.Concrete.WXAdminMenuBLL();
    var adminMenuConfig = bll.ConfigMenu();
    //var permissions = AdminUserContext.Current.LoginInfo.BusinessPermissionList.Select(p => p.ToString());
}
<script type="text/javascript" src="~/Content/Scripts/jquery-1.10.2.js"></script>

<script>
    $(document).ready(function () {

        ///菜单导航处理
        //var handleMainMenu = function () {
        jQuery('.page-sidebar .has-sub > a').click(function () {
            var handleContentHeight = function () {
                var content = $('.page-content');
                var sidebar = $('.page-sidebar');

                if (!content.attr("data-height")) {
                    content.attr("data-height", content.height());
                }


                if (sidebar.height() > content.height()) {
                    content.css("min-height", sidebar.height() + 20);
                } else {
                    content.css("min-height", content.attr("data-height"));
                }
            }

            var last = jQuery('.has-sub.open', $('.page-sidebar'));
            if (last.size() == 0) {
                //last = jQuery('.has-sub.active', $('.page-sidebar'));
            }
            last.removeClass("open");
            jQuery('.arrow', last).removeClass("open");
            jQuery('.sub', last).slideUp(200);

            var sub = jQuery(this).next();
            if (sub.is(":visible")) {
                jQuery('.arrow', jQuery(this)).removeClass("open");
                jQuery(this).parent().removeClass("open");
                sub.slideUp(200, function () {
                    handleContentHeight();
                });
            } else {
                jQuery('.arrow', jQuery(this)).addClass("open");
                jQuery(this).parent().addClass("open");
                sub.slideDown(200, function () {
                    handleContentHeight();
                });
            }
        });
        //}

        ///隐藏菜单
        //var handleSidebarToggler = function () {

        var container = $(".page-container");

        if ($.cookie('sidebar-closed') == 1) {
            container.addClass("sidebar-closed");
        }

        // handle sidebar show/hide
        $('.page-sidebar .sidebar-toggler').click(function () {
            $(".sidebar-search").removeClass("open");
            var container = $(".page-container");
            if (container.hasClass("sidebar-closed") === true) {
                container.removeClass("sidebar-closed");
                $.cookie('sidebar-closed', null);
            } else {
                container.addClass("sidebar-closed");
                $.cookie('sidebar-closed', 1);
            }
            if (App.isPage("charts")) {
                setTimeout(function () {
                    handleChartGraphs();
                }, 100);
            }
        });

        // handle the search bar close
        $('.sidebar-search .remove').click(function () {
            $('.sidebar-search').removeClass("open");
        });

        // handle the search query submit on enter press
        $('.sidebar-search input').keypress(function (e) {
            if (e.which == 13) {
                window.location.href = "extra_search.html";
                return false; //<---- Add this line
            }
        });

        // handle the search submit
        $('.sidebar-search .submit').click(function () {
            if ($('.page-container').hasClass("sidebar-closed")) {
                if ($('.sidebar-search').hasClass('open') == false) {
                    $('.sidebar-search').addClass("open");
                } else {
                    window.location.href = "extra_search.html";
                }
            } else {
                window.location.href = "extra_search.html";
            }
        });
        //}
        //var handleStyler = function () {

        ///更换主题
        var panel = $('.color-panel');

        $('.icon-color', panel).click(function () {
            $('.color-mode').show();
            $('.icon-color-close').show();
        });

        $('.icon-color-close', panel).click(function () {
            $('.color-mode').hide();
            $('.icon-color-close').hide();
        });

        $('li', panel).click(function () {
            var color = $(this).attr("data-style");
            setColor(color);
            $('.inline li', panel).removeClass("current");
            $(this).addClass("current");
        });

        $('input', panel).change(function () {
            setLayout();
        });

        var setColor = function (color) {
            $('#style_color').attr("href", "/Assets/css/style_" + color + ".css");
        }

        var setLayout = function () {
            if ($('input.header', panel).is(":checked")) {
                $("body").addClass("fixed-top");
                $(".header").addClass("navbar-fixed-top");
            } else {
                $("body").removeClass("fixed-top");
                $(".header").removeClass("navbar-fixed-top");
            }
        }
        //}

    });


</script>
<div class="page-sidebar nav-collapse">
    <script type="text/javascript" src="~/Assets/js/apps.js"></script>
    <!-- BEGIN SIDEBAR MENU -->
    <ul>
        <li>
            <!-- BEGIN SIDEBAR TOGGLER BUTTON -->
            <div class="sidebar-toggler hidden-phone"><h3 style="margin-left:-160px; line-height:23px;  color:#666; ">微信功能菜单</h3></div>
            <!-- BEGIN SIDEBAR TOGGLER BUTTON -->
        </li>
        <li>
            <!-- BEGIN RESPONSIVE QUICK SEARCH FORM -->
            <form class="sidebar-search dn">
                <div class="input-box">
                    <a href="javascript:;" class="remove"></a>
                    <input type="text" placeholder="Search..." />
                    <input type="button" class="submit" value=" " />
                </div>
            </form>
            <!-- END RESPONSIVE QUICK SEARCH FORM -->
        </li>
        @foreach (var group in adminMenuConfig.AdminMenuGroups)
        {
            if (!string.IsNullOrEmpty(group.Permission))
            {
                continue;
            }

            var menus = group.AdminMenuArray.Where(m => string.IsNullOrEmpty(m.Permission));
            var hasSub = menus.Count() > 0;

            //if (!hasSub && string.IsNullOrEmpty(group.Url))
            //{
            //    continue;
            //}

            <li class="@(hasSub?"has-sub":string.Empty)">
                <a href="@(hasSub ? "javascript:;" : group.Url)" title="@group.Info">
                    <i class="@group.Icon"></i>
                    <span class="title">@group.Name</span>
                    @if (hasSub)
                {
                        <span class='arrow'></span>
                    }
                </a>
                @if (hasSub)
                {
                    <ul class="sub">
                        @foreach (var menu in menus)
                    {
                            @*<li><a href="@menu.Url" title="@menu.Info">@menu.Name</a></li>*@
                            <li>
                                @Html.ActionLink(@menu.Name, @menu.Url.Split(new char[] { '/' })[2], @menu.Url.Split(new char[] { '/' })[1], new { id = @Html.ViewContext.HttpContext.Session["wxAccount"] }, "")
                            </li>
                        }
                    </ul>
                }
            </li>
        }
    </ul>
    <!-- END SIDEBAR MENU -->
</div>


